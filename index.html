<script type="text/javascript">
	atOptions = {
		'key' : 'a0af78d8a490493a35c10b807dc29e4c',
		'format' : 'iframe',
		'height' : 60,
		'width' : 468,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/a0af78d8a490493a35c10b807dc29e4c/invoke.js"></script>
<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Rath Yatra Wishes</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tiro+Devanagari+Hindi:wght@400&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tiro Devanagari Hindi', serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            background-color: #FFF8E1; /* Light Creamy Yellow */
            background-image: url("data:image/svg+xml,%3Csvg width='52' height='26' viewBox='0 0 52 26' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23FFDAB9' fill-opacity='0.2'%3E%3Cpath d='M10 10c0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6h2c0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4v2c-3.314 0-6-2.686-6-6 0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6zm25.464-1.95l8.486 8.486-1.414 1.414-8.486-8.486 1.414-1.414zM41.828 15.536l8.486-8.486 1.414 1.414-8.486 8.486-1.414-1.414zM15.536 41.828l8.486-8.486 1.414 1.414-8.486 8.486-1.414-1.414zM0 26h52v-2H0v2z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        #fireworksCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }
        .container {
            background-color: rgba(255, 255, 255, 0.95);
            padding: 25px 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(128, 0, 0, 0.2);
            max-width: 550px;
            width: 90%;
            border: 2px solid #FFC107;
            z-index: 1;
        }
        img.rath-yatra-gif {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 3px solid #FF9800;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .greeting {
            font-size: 28px;
            color: #D32F2F;
            margin-bottom: 8px;
            animation: fadeInGreeting 2s ease-in-out;
            font-weight: 600;
        }
        @keyframes fadeInGreeting {
            0% { opacity: 0; transform: translateY(-10px) scale(0.95); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }
        .sender-info {
            font-size: 20px;
            color: #FF6F00;
            margin-bottom: 20px;
            font-weight: bold;
            animation: slideInSender 1.5s ease-out 0.5s;
            animation-fill-mode: backwards;
        }
         @keyframes slideInSender {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        .input-label {
            display: block;
            margin-top: 20px;
            margin-bottom: 8px;
            color: #5D4037;
            font-size: 18px;
        }
        input[type="text"] {
            padding: 12px;
            border: 2px solid #FFD54F;
            border-radius: 8px;
            width: calc(100% - 28px);
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
        }
        input[type="text"]:focus {
            border-color: #FFB300;
            outline: none;
            box-shadow: 0 0 8px rgba(255, 179, 0, 0.3);
        }
        
        button.whatsapp-share-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 20px;
            margin-top: 20px;
            background-color: #25D366; /* WhatsApp Green */
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 17px;
            font-family: 'Tiro Devanagari Hindi', serif;
            font-weight: 600;
            transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        button.whatsapp-share-button svg {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            fill: white;
        }
        button.whatsapp-share-button:hover {
            background-color: #1DA851; /* Darker WhatsApp Green */
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(37, 211, 102, 0.4);
        }

        .share-link-container {
            margin-top: 25px;
            word-wrap: break-word;
        }
        .share-link-container p.fallback-title { /* More specific class */
            font-weight: bold;
            color: #5D4037; /* Brownish text */
            font-size: 16px;
            margin-bottom: 5px;
        }
        #generatedLink {
            color: #00796B;
            text-decoration: none;
            font-family: 'Poppins', sans-serif;
            font-size: 15px;
            background-color: #E0F2F1;
            padding: 5px 8px;
            border-radius: 5px;
            display: inline-block;
        }
        #generatedLink:hover {
            text-decoration: underline;
            color: #004D40;
        }
        .copy-button {
            padding: 8px 15px;
            margin-left: 10px;
            background-color: #FF9800; /* Orange for copy button */
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-family: 'Tiro Devanagari Hindi', serif;
        }
        .copy-button:hover {
            background-color: #FB8C00; /* Darker Orange */
        }
        .hidden {
            display: none;
        }
        #copyMessage {
            font-size: 14px;
            color: #388E3C;
            margin-top: 8px;
            min-height: 20px;
        }
    </style>
</head>
<body>
    <canvas id="fireworksCanvas"></canvas>

    <div class="container">
        <p class="greeting" id="mainGreeting">Happy Rath Yatra!</p>
        <div id="senderInfoContainer" class="hidden">
            <p class="sender-info" id="senderNameDisplay"></p>
        </div>

        <img src="Happy Rath Yatra.gif" alt="Happy Rath Yatra Animation" class="rath-yatra-gif">

        <div id="nameInputSection">
            <label for="senderNameInput" class="input-label">आपका नाम दर्ज करें:</label>
            <input type="text" id="senderNameInput" placeholder="यहाँ अपना नाम लिखें">
            
            <button class="whatsapp-share-button" onclick="processAndShare()">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.59 15.31 3.4 16.78L2.03 21.96L7.39 20.64C8.79 21.39 10.38 21.82 12.04 21.82C17.5 21.82 21.95 17.37 21.95 11.91C21.95 6.45 17.5 2 12.04 2M12.04 3.67C16.55 3.67 20.28 7.39 20.28 11.91C20.28 16.43 16.55 20.15 12.04 20.15C10.56 20.15 9.18 19.78 7.99 19.1L7.53 18.85L4.5 19.7L5.39 16.78L5.11 16.3C4.39 15.03 4.01 13.53 4.01 11.91C4.01 7.39 7.73 3.67 12.04 3.67M17.31 14.5C17.07 14.38 15.91 13.84 15.69 13.75C15.48 13.67 15.32 13.63 15.16 13.87C15 14.12 14.52 14.67 14.36 14.84C14.2 15 14.03 15.04 13.79 14.92C13.55 14.8 12.78 14.54 11.85 13.7C11.13 13.06 10.66 12.26 10.51 12C10.35 11.75 10.46 11.62 10.58 11.5L10.69 11.37C10.8 11.25 10.85 11.11 10.93 10.97C11.01 10.83 10.97 10.71 10.92 10.6C10.87 10.48 10.42 9.32 10.24 8.86C10.05 8.4 9.86 8.44 9.73 8.43C9.61 8.42 9.45 8.42 9.29 8.42C9.12 8.42 8.88 8.48 8.68 8.73C8.48 8.97 7.99 9.45 7.99 10.58C7.99 11.71 9.32 12.94 9.48 13.11C9.63 13.28 10.43 14.47 11.95 15.16C12.73 15.51 13.26 15.71 13.66 15.86C14.27 16.09 14.79 16.05 15.21 15.95C15.68 15.83 16.83 15.23 17.07 14.92C17.31 14.62 17.31 14.38 17.31 14.5Z"></path></svg>
                WhatsApp पर शेयर करें
            </button>
        </div>

        <div id="shareLinkFallbackContainer" class="share-link-container hidden">
            <p class="fallback-title">या यह लिंक कॉपी करके शेयर करें:</p>
            <a href="#" id="generatedLink" target="_blank"></a>
            <button class="copy-button" onclick="copyLink()">कॉपी करें</button>
            <p id="copyMessage"></p>
        </div>
    </div>

    <script>
        const gifImage = document.querySelector('.rath-yatra-gif');
        const mainGreetingElement = document.getElementById('mainGreeting');
        const senderInfoContainer = document.getElementById('senderInfoContainer');
        const senderNameDisplayElement = document.getElementById('senderNameDisplay');
        const shareLinkFallbackContainer = document.getElementById('shareLinkFallbackContainer');
        const generatedLinkElement = document.getElementById('generatedLink');
        const copyMessageElement = document.getElementById('copyMessage');

        // --- Enhanced Firecracker Code ---
        const fireworksCanvas = document.getElementById('fireworksCanvas');
        const ctx = fireworksCanvas.getContext('2d');
        let fireworks = [];
        let particles = [];

        function setupCanvas() {
            fireworksCanvas.width = window.innerWidth;
            fireworksCanvas.height = window.innerHeight;
        }
        setupCanvas();
        window.addEventListener('resize', setupCanvas);

        function Firework(sx, sy, tx, ty) {
            this.x = sx; this.y = sy; this.sx = sx; this.sy = sy; this.tx = tx; this.ty = ty;
            this.distanceToTarget = Math.sqrt(Math.pow(tx - sx, 2) + Math.pow(ty - sy, 2));
            this.distanceTraveled = 0; this.coordinates = []; this.coordinateCount = 3;
            while (this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
            this.angle = Math.atan2(ty - sy, tx - sx); this.speed = 2.5; /*Slightly faster rocket*/ this.acceleration = 1.04;
            this.brightness = Math.random() * 50 + 60; /*Brighter*/ this.targetRadius = 1;
        }
        Firework.prototype.update = function(index) {
            this.coordinates.pop(); this.coordinates.unshift([this.x, this.y]);
            if (this.targetRadius < 8) { this.targetRadius += 0.4; /*Faster target indicator grow*/ } else { this.targetRadius = 1; }
            this.speed *= this.acceleration; const vx = Math.cos(this.angle) * this.speed; const vy = Math.sin(this.angle) * this.speed;
            this.distanceTraveled = Math.sqrt(Math.pow(this.x + vx - this.sx, 2) + Math.pow(this.y + vy - this.sy, 2));
            if (this.distanceTraveled >= this.distanceToTarget) { createParticles(this.tx, this.ty); fireworks.splice(index, 1); } else { this.x += vx; this.y += vy; }
        };
        Firework.prototype.draw = function() {
            ctx.beginPath(); ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            ctx.lineTo(this.x, this.y); ctx.strokeStyle = `hsl(${Math.random() * 60 + 0}, 100%, ${this.brightness}%)`; ctx.stroke();
            // Target indicator (optional but nice)
            // ctx.beginPath(); ctx.arc(this.tx, this.ty, this.targetRadius, 0, Math.PI * 2); ctx.stroke();
        };
        function Particle(x, y) {
            this.x = x; this.y = y; this.coordinates = []; this.coordinateCount = 5;
            while (this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
            this.angle = Math.random() * Math.PI * 2; this.speed = Math.random() * 12 + 2; /* Increased particle speed */
            this.friction = 0.96; /* Slightly less friction for wider spread */ this.gravity = 1.2; /* Slightly stronger gravity */
            this.hue = Math.random() * 60 + 0; // Oranges, Yellows, Reds
            this.brightness = Math.random() * 60 + 50; /* Brighter particles */ this.alpha = 1;
            this.decay = Math.random() * 0.025 + 0.015; /* Adjusted decay */
        }
        Particle.prototype.update = function(index) {
            this.coordinates.pop(); this.coordinates.unshift([this.x, this.y]); this.speed *= this.friction;
            this.x += Math.cos(this.angle) * this.speed; this.y += Math.sin(this.angle) * this.speed + this.gravity;
            this.alpha -= this.decay; if (this.alpha <= this.decay) { particles.splice(index, 1); }
        };
        Particle.prototype.draw = function() {
            ctx.beginPath(); ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            ctx.lineTo(this.x, this.y); ctx.strokeStyle = `hsla(${this.hue}, 100%, ${this.brightness}%, ${this.alpha})`; ctx.stroke();
        };
        
        function createParticles(x, y) { 
            let particleCount = Math.random() * 40 + 50; // Increased: 50 to 90 particles
            while (particleCount--) { particles.push(new Particle(x, y)); } 
        }

        let fireworkInterval; let fireworksActive = false; let fireworksDuration = 6000; // Slightly longer duration
        let fireworksLaunched = 0; const maxFireworksTotal = 22; // Max fireworks in one go
        
        function launchFirework() {
            if(fireworksLaunched < maxFireworksTotal && fireworks.length < 10) { // Limit concurrent rockets on screen
                const startX = fireworksCanvas.width * (Math.random() * 0.8 + 0.1) ; // Launch from a central 80%
                const startY = fireworksCanvas.height;
                const targetX = startX + (Math.random() - 0.5) * 100; // Slight horizontal variation
                const targetY = fireworksCanvas.height * (Math.random() * 0.4 + 0.1); // Explode in top 10-50%
                fireworks.push(new Firework(startX, startY, targetX, targetY)); 
                fireworksLaunched++;
            }
        }
        function animateFireworks() {
            if (!fireworksActive && particles.length === 0) return; // Stop if not active and no particles left

            ctx.globalCompositeOperation = 'destination-out'; ctx.fillStyle = 'rgba(0, 0, 0, 0.4)'; // Slightly less clear for trails
            ctx.fillRect(0, 0, fireworksCanvas.width, fireworksCanvas.height); ctx.globalCompositeOperation = 'lighter';
            
            let i = fireworks.length; while (i--) { fireworks[i].draw(); fireworks[i].update(i); }
            let j = particles.length; while (j--) { particles[j].draw(); particles[j].update(j); }
            
            if (fireworksActive || particles.length > 0) { // Continue animation if active or particles exist
                requestAnimationFrame(animateFireworks);
            }
        }
        function startFireworkDisplay() {
            if (fireworksActive) return; 
            fireworksActive = true; fireworksLaunched = 0; fireworks = []; particles = [];
            
            for(let k=0; k < 7; k++) { // Initial burst of 7
                 if(fireworksLaunched < maxFireworksTotal) launchFirework(); 
            }
            fireworkInterval = setInterval(launchFirework, 350); // Launch new ones every 350ms
            
            animateFireworks(); // Start the animation loop

            setTimeout(() => {
                stopFireworkDisplay();
            }, fireworksDuration);
        }
        function stopFireworkDisplay() {
            clearInterval(fireworkInterval);
            // Allow existing fireworks to complete their course, then stop launching new ones
            // The animation loop will stop itself when fireworksActive is false and particles are gone.
            setTimeout(() => { 
                fireworksActive = false; 
            }, 2000); // Give time for launched fireworks to explode
        }
        // --- End Firecracker Code ---

        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            const results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        window.onload = function() {
            const senderName = getUrlParameter('by');
            function triggerAnimation(element, animationName) {
                element.style.animation = 'none';
                void element.offsetWidth; 
                element.style.animation = animationName;
            }

            if (senderName) {
                mainGreetingElement.textContent = `Happy Rath Yatra!`;
                senderNameDisplayElement.textContent = `${senderName} की ओर से हार्दिक शुभकामनाएं!`;
                senderInfoContainer.classList.remove('hidden');
                triggerAnimation(mainGreetingElement, 'fadeInGreeting 2s ease-in-out');
                triggerAnimation(senderNameDisplayElement, 'slideInSender 1.5s ease-out 0.5s');
                const originalSrc = gifImage.src;
                gifImage.src = '';
                gifImage.src = originalSrc;
                startFireworkDisplay();
            } else {
                mainGreetingElement.textContent = "Happy Rath Yatra!";
                senderInfoContainer.classList.add('hidden');
                triggerAnimation(mainGreetingElement, 'fadeInGreeting 2s ease-in-out');
            }
        }

        function displayShareFallback(link) {
            generatedLinkElement.href = link;
            generatedLinkElement.textContent = link;
            shareLinkFallbackContainer.classList.remove('hidden');
            copyMessageElement.textContent = "";
        }

        async function processAndShare() {
            const nameInput = document.getElementById('senderNameInput');
            const senderName = nameInput.value.trim();

            if (senderName === "") {
                alert("कृपया अपना नाम दर्ज करें।");
                return;
            }

            const baseUrl = window.location.origin + window.location.pathname;
            const shareableLink = `${baseUrl}?by=${encodeURIComponent(senderName)}`;
            
            const shareTitle = 'Happy Rath Yatra!';
            const greetingMessage = `*${senderName}* आपको रथ यात्रा की हार्दिक शुभकामनाएं भेज रहे हैं! 💐`;
            const fullMessageForWhatsapp = `${greetingMessage}\n\nयह शुभकामना संदेश देखें:\n${shareableLink}`;
            const textForWebShare = `${greetingMessage}\n\nदेखने के लिए क्लिक करें: ${shareableLink}`;


            // Clear any previous copy message or link
            shareLinkFallbackContainer.classList.add('hidden');
            copyMessageElement.textContent = "";

            if (navigator.share) {
                try {
                    await navigator.share({
                        title: shareTitle,
                        text: textForWebShare, // Use this for Web Share as it handles URL separately
                        url: shareableLink, // URL is separate for Web Share API
                    });
                    console.log('Successfully shared via Web Share API');
                } catch (error) {
                    console.error('Error sharing via Web Share API:', error);
                    // Fallback to WhatsApp link if Web Share API fails (e.g., user cancels)
                    // Also show copy link as primary fallback on error
                    window.open(`https://wa.me/?text=${encodeURIComponent(fullMessageForWhatsapp)}`, '_blank');
                    displayShareFallback(shareableLink);
                }
            } else {
                // Fallback for browsers that don't support Web Share API (e.g., most desktop)
                console.log('Web Share API not supported, opening WhatsApp link and showing fallback.');
                window.open(`https://wa.me/?text=${encodeURIComponent(fullMessageForWhatsapp)}`, '_blank');
                displayShareFallback(shareableLink);
            }
        }

        function copyLink() {
            const linkText = document.getElementById('generatedLink').href;
            navigator.clipboard.writeText(linkText).then(function() {
                copyMessageElement.textContent = "लिंक सफलतापूर्वक कॉपी हो गया!";
                setTimeout(() => {
                    copyMessageElement.textContent = "";
                }, 3000);
            }, function(err) {
                copyMessageElement.textContent = "लिंक कॉपी करने में विफल रहा।";
                console.error('Could not copy text: ', err);
            });
        }
    </script>
</body>
</html>
<script type="text/javascript">
	atOptions = {
		'key' : 'a0af78d8a490493a35c10b807dc29e4c',
		'format' : 'iframe',
		'height' : 60,
		'width' : 468,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/a0af78d8a490493a35c10b807dc29e4c/invoke.js"></script>